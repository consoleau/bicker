(function(){angular.module("bicker_router",["ngAnimate"]).run(["State","Route","$location","$rootScope","ObjectHelper","PendingViewCounter",function(a,b,c,d,e,f){"ngInject";var g;return g=void 0,d.$on("$locationChangeStart",function(){if(b.isReady())return b.setReady(!1)}),d.$on("$locationChangeSuccess",function(h,i){var j,k,l,m,n,o,p;if(i!==g){g=i,f.reset(),n=b.match(c.path()),j=n?b.extractData(n):{},l=e.notIn(a.list,j),l=_.difference(l,b.getPersistentStates().concat(b.getFlashStates())),k={unsetting:l,setting:j},d.$emit("bicker_router.beforeStateChange",k),0!==k.unsetting.length&&a.unset(k.unsetting),o=k.setting;for(m in o)p=o[m],a.set(m,p);b.resetFlashStates(),b.setReady(!0)}})}])}).call(this),function(){var a=[].slice;angular.module("bicker_router").constant("ObjectHelper",{get:function(a,b){var c,d,e,f,g,h;if(""===b)return a;for(g=b.split("."),d=g.pop(),f=a,c=0,e=g.length;c<e;c++)if(h=g[c],f=f[h],void 0===f)return;return f[d]},set:function(a,b,c){var d,e,f,g,h,i;for(h=b.split("."),e=h.pop(),g=a,d=0,f=h.length;d<f;d++)i=h[d],void 0===g[i]&&(g[i]={}),g=g[i];return g[e]=c},unset:function(a,b){var c,d,e,f,g,h;if(""===b)return a;for(g=b.split("."),d=g.pop(),f=a,c=0,e=g.length;c<e;c++)if(h=g[c],f=f[h],void 0===f)return!1;return void 0!==f[d]&&(delete f[d],!0)},notIn:function(a,b,c){var d,e,f,g,h,i;for(null==c&&(c=""),g=[],c=c.length>0?c+".":"",h=Object.keys(a),d=0,f=h.length;d<f;d++)e=h[d],i=""+c+e,void 0===b[e]?g.push(i):"object"!=typeof a[e]||a[e]instanceof Array||(g=g.concat(this.notIn(a[e],b[e],i)));return g},"default":function(){var b,c,d,e,f,g;e=arguments[0],c=2<=arguments.length?a.call(arguments,1):[],f={},b=1===c.length?c[0]:this["default"].apply(this,c);for(d in b)g=b[d],g instanceof Array?f[d]=e[d]||g:"object"==typeof g&&"object"==typeof e[d]?f[d]=this["default"](e[d],g):f[d]=e[d]||g;for(d in e)g=e[d],f[d]=f[d]||g;return f}})}.call(this),function(){angular.module("bicker_router").directive("routeHref",["Route","$location","$timeout",function(a,b,c){return{restrict:"A",scope:!0,link:function(d,e,f){var g,h,i;void 0===f.ignoreHref&&e.click(function(d){var f;return d.preventDefault(),f=e.attr("href"),a.isHtml5ModeEnabled()||(f=f.replace(/^#/,"")),c(function(){return b.url(f)})}),g=a.getUrlWriters();for(i in g)h=g[i],d[i+"UrlWriter"]=h;return d.$watch(f.routeHref,function(b){var c;return c=a.isHtml5ModeEnabled()?b:"#"+b,e.attr("href",c)})}}}])}.call(this),function(){angular.module("bicker_router").directive("view",["$log","$compile","$controller","ViewBindings","$q","State","$rootScope","$animate","$timeout","$injector","PendingViewCounter","$templateRequest","Route",function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n;return n={restrict:"E",scope:!1,replace:!0,template:"<div></div>",link:function(n,o,p){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R;return P=!1,R=void 0,Q=!1,O=d.getView(p.name),q=O.getBindings(),o.addClass("ng-hide"),D=void 0,C=void 0,x=function(a){return _.cloneDeep(f.getSubset(y(a)))},u=function(a,b){var c;return null==b&&(b="component"),c=a[b]?j.get(a[b]+"Directive")[0]:a,_.defaults(_.pick(c,["controller","templateUrl","controllerAs"]),{controllerAs:"$ctrl"})},A=function(a){var b,c,d,e,g,h;for(g=a.requiredState||[],c=0,d=g.length;c<d;c++){if(h=g[c],e=!1,"!"===h.charAt(0)&&(h=h.slice(1),e=!0),b=f.get(h),null==b)return!1;if(e&&(b=!b),!b)return!1}return!(a.canActivate&&!j.invoke(a.canActivate))},B=function(a,b){var c,d;return(c=w(b))?(d=x(c),c===C&&angular.equals(D,d)?void 0:(C=c,D=d,k.increase(),M(a,c).then(function(b){var d;return d=b?300:void 0,P?(R.$destroy(),r(a,c,d)):h.removeClass(a,"ng-hide").then(function(b){return function(){return r(a,c,d)}}(this))}))):void(P&&(h.addClass(a,"ng-hide").then(function(b){return function(){return s(a)}}(this)),D=void 0,C=void 0))},w=function(a){var b,c,d;for(c=0,d=a.length;c<d;c++)if(b=a[c],A(b))return b},s=function(a){if(P!==!1)return P=!1,a.children().eq(0).remove(),R.$destroy()},r=function(b,c,d){var f,g,h,j,m;return m=Date.now(),f=u(c),h=function(a){var e,g,h;if(w(q)===c)return P=!0,h=Date.now()-m,e=function(){var d;try{return E(b,f,a)}catch(e){return d=e,H(d,b,c)}finally{i(function(){if(!c.manualCompletion)return k.decrease()})}},g=Math.max(0,d-h),h<d?i(function(){return e()},g):e()},g=function(d){return i(function(){if(!c.manualCompletion)return k.decrease()}),a.error(d),K(d,b,c)},j={template:l(f.templateUrl),dependencies:F(c)},e.all(j).then(h,g)},M=function(a,c){var d;return c.resolvingTemplateUrl&&c.resolve&&0!==Object.keys(c.resolve).length?l(c.resolvingTemplateUrl).then(function(c){return a.html(c),b(a.contents())(g.$new())}):(d=e.defer(),d.resolve(!1),d.promise)},K=function(a,b,c){return c.resolvingErrorTemplateUrl?L(b,c):c.resolvingErrorComponent?I(a,b,c,"resolvingErrorComponent"):void 0},L=function(a,b){return G(a,b,"resolvingErrorTemplateUrl")},H=function(a,b,c){var d;return d=null,c.errorTemplateUrl?d=J(b,c):c.errorComponent&&(d=I(a,b,c)),i(function(){if(!c.manualCompletion)return k.decrease()}),d},J=function(a,b){return G(a,b,"errorTemplateUrl")},G=function(a,c,d){if(c[d])return l(c[d]).then(function(c){var d;return a.html(c),d=b(a.contents()),R=n.$new(),d(R)})},I=function(a,b,c,d){var e,f;if(null==d&&(d="errorComponent"),c[d])return f=u(c,d),e={dependencies:{error:a}},l(f.templateUrl).then(function(a){return e.template=a,E(b,f,e)})},E=function(a,d,e){var f,g,h,i,j;return g=e.dependencies,j=e.template,a.html(j),h=b(a.contents()),R=n.$new(),d.controller&&(i=_.merge(g,{$scope:R,$element:a.children().eq(0)}),f=c(d.controller,i),i.$scope[d.controllerAs]=f),h(R)},F=function(a){var b,c,d,f,g,h;if(!a.resolve||0===Object.keys(a.resolve).length)return b=e.defer(),b.resolve({}),b.promise;g={},h=a.resolve;for(d in h){c=h[d];try{g[d]=j.invoke(c)}catch(i){f=i,g[d]=e.reject(f)}}return e.all(g)},y=function(a){return _.union(a.requiredState||[],a.watchedState||[])},N=function(a){return"!"===a.charAt(0)?a.substr(1):a},z=function(a){return _.flatten(_.map(a.getBindings(),y))},v=function(a){return _.uniq(_.map(z(a),N))},t=v(O),m.whenReady().then(function(){var a;if(Q=!0,B(o,q),Q=!1,0!==t.length)return a=function(){if(!Q)return Q=!0,i(function(){return B(o,q),Q=!1})},f.watch(t,a),n.$on("$destroy",function(){return f.removeWatcher(a)})})}}}])}.call(this),function(){angular.module("bicker_router").factory("PendingViewCounter",["$rootScope",function(a){var b;return new(b=function(){function b(){}return b.prototype.count=0,b.prototype.initialViewsLoaded=!1,b.prototype.get=function(){return this.count},b.prototype.increase=function(){return this.count+=1},b.prototype.decrease=function(){if(this.count=Math.max(0,this.count-1),0===this.count)return this.initialViewsLoaded?a.$broadcast("bicker_router.currentViewsLoaded"):(a.$broadcast("bicker_router.initialViewsLoaded"),this.initialViewsLoaded=!0)},b.prototype.reset=function(){return this.count=0,this.initialViewsLoaded=!1},b}())}])}.call(this),function(){angular.module("bicker_router").factory("WatchableListFactory",["ObjectHelper","WatcherFactory",function(a,b){var c,d;return c=function(){function c(a){this.list=a,this.watchers=[]}return c.prototype.get=function(b){return a.get(this.list,b)},c.prototype.getAll=function(){return this.list},c.prototype.getSubset=function(a){return _.zipObject(a,_.map(a,this.get.bind(this)))},c.prototype.set=function(b,c){return a.set(this.list,b,c),this._notifyWatchers(b,c)},c.prototype.unset=function(b){var c,d,e,f;for(b instanceof Array||(b=[b]),f=[],c=0,d=b.length;c<d;c++)e=b[c],a.unset(this.list,e),f.push(this._notifyWatchers(e,void 0));return f},c.prototype.watch=function(a,c){var d,e,f,g;for(a instanceof Array||(a=[a]),g=[],d=0,e=a.length;d<e;d++)f=a[d],g.push(this.watchers.push(b.create(f,c,this.get(f))));return g},c.prototype.removeWatcher=function(a){var b,c,d,e;if(0!==this.watchers.length){for(d=[],c=b=0,e=this.watchers.length-1;0<=e?b<=e:b>=e;c=0<=e?++b:--b)this.watchers[c].handler!==a&&d.push(this.watchers[c]);return this.watchers=d}},c.prototype._notifyWatchers=function(b){var c,d,e,f,g,h;for(e=this.watchers,f=[],c=0,d=e.length;c<d;c++)h=e[c],g=a.get(this.list,h.watchPath),h.shouldNotify(b,g)?f.push(h.notify(b,g)):f.push(void 0);return f},c}(),d={create:function(a){return null==a&&(a={}),new c(a)}}}])}.call(this),function(){angular.module("bicker_router").factory("WatcherFactory",function(){var a,b;return a=function(){function a(a,b,c){this.watchPath=a,this.handler=b,null==c&&(c=void 0),this.currentValue=_.cloneDeep(c)}return a.prototype.shouldNotify=function(a,b){return!angular.equals(this.currentValue,b)},a.prototype.notify=function(a,b){return this.handler(a,b,this.currentValue),this.currentValue=_.cloneDeep(b)},a}(),b={create:function(b,c,d){return null==d&&(d=void 0),new a(b,c,d)}}})}.call(this),function(){var a=[].slice,b=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};angular.module("bicker_router").provider("Route",["ObjectHelper",function(c){"ngInject";var d,e,f,g,h,i,j,k;return h={},j={},k=[],e=[],g=!1,i={},d=!1,f={registerType:function(a,b){return i[a]=b,i[a].regex=new RegExp(i[a].regex.source,"i"),_.extend({and:this.registerType},this)},registerUrlToken:function(a,b){return h[a]=_.extend({name:a},b),_.extend({and:this.registerUrlToken},this)},registerUrlWriter:function(a,b){return j[a]=b,_.extend({and:this.registerUrlWriter},this)},registerUrl:function(a,b){var c;return null==b&&(b={}),c={compiledUrl:this._compileUrlPattern(a,b),pattern:a},k.push(_.extend(c,b)),_.extend({and:this.registerUrl},this)},setPersistentStates:function(){var c,d,f,g,h;for(h=1<=arguments.length?a.call(arguments,0):[],f=[],c=0,d=h.length;c<d;c++)g=h[c],b.call(e,g)<0?f.push(e.push(g)):f.push(void 0);return f},setHtml5Mode:function(a){return d=a},_compileUrlPattern:function(a,b){var c,d,e,f,g,j;for(a=this._escapeRegexSpecialCharacters(a),a=this._ensureOptionalTrailingSlash(a),g=/\{([A-Za-z\._0-9]+)\}/g,j=a,b.partialMatch||(j="^"+j+"$"),f=[];null!==(d=g.exec(a));)e=h[d[1]],f.push(e),j=j.replace(d[0],"("+i[e.type].regex.source+")");return j.replace(".","\\."),c={regex:new RegExp(j,"i"),tokens:f}},_ensureOptionalTrailingSlash:function(a){return a.match(/\/$/)?a.replace(/\/$/,"/?"):a+"/?"},_escapeRegexSpecialCharacters:function(a){return a.replace(/[\-\[\]\/\(\)\*\+\?\\\^\$\|]/g,"\\$&")},$get:["$location","State","$injector","$q",function(b,f,g,l){var m,n;return _.forIn(j,function(a,b){return j[b]=function(b){var c;return null==b&&(b={}),c={UrlData:b},g.invoke(a,{},c)}}),m=[],n={readyDeferred:l.defer(),match:function(a){var b,c,d,e;for(b=0,c=k.length;b<c;b++)if(e=k[b],null!==(d=e.compiledUrl.regex.exec(a)))return{url:e,regexMatch:d};return null},extractData:function(a,b){var d,e;return null==b&&(b=void 0),d=this.extractDefaultData(a),e=this.extractPathData(a),b=this.extractSearchData(b),c["default"](b,e,d)},extractSearchData:function(a){var d,e,f,j,k,l,m,n,o,p,q,r;null==a&&(a=b.search()),d=_.clone(a),j={};for(f in d)r=d[f],q=_.findKey(h,{searchAlias:f}),null==q&&(q=f),(!h[q]||(null!=(k=i[null!=(l=h[q])?l.type:void 0])?k.regex.test(r):void 0))&&((null!=(m=i[null!=(n=h[q])?n.type:void 0])?m.parser:void 0)&&(r=g.invoke(null!=(o=i[h[q].type])?o.parser:void 0,null,{token:r})),e=(null!=(p=h[q])?p.statePath:void 0)||q,c.set(j,e,r));return j},extractDefaultData:function(a){var b,d,e,f;b={},e=a.url.state;for(d in e)f=e[d],c.set(b,d,"object"==typeof f?_.cloneDeep(f):f);return b},extractPathData:function(a){var b,d,e,f,h,j,k;if(b={},f=a.url.compiledUrl.tokens,0===f.length)return{};for(e=d=0,h=f.length-1;0<=h?d<=h:d>=h;e=0<=h?++d:--d)j=a.url.compiledUrl.tokens[e],k=a.regexMatch[e+1],i[j.type].parser&&(k=g.invoke(i[j.type].parser,null,{token:k})),c.set(b,j.statePath||j.name,k);return b},getUrlWriters:function(){return j},getUrlWriter:function(a){return j[a]},invokeUrlWriter:function(a,b){return null==b&&(b={}),j[a](b)},go:function(a,c){return null==c&&(c={}),b.url(this.invokeUrlWriter(a,c))},getPersistentStates:function(){return e},resetFlashStates:function(){return m=[]},addFlashStates:function(){var b;return b=1<=arguments.length?a.call(arguments,0):[],m=m.concat(b)},getFlashStates:function(){return m},setReady:function(a){return a?this.readyDeferred.resolve():this.readyDeferred=l.defer(),this.ready=a},isReady:function(){return this.ready},isHtml5ModeEnabled:function(){return d},whenReady:function(){return this.readyDeferred.promise}}}]},f.registerType("numeric",{regex:/\d+/,parser:["token",function(a){return parseInt(a)}]}),f.registerType("alpha",{regex:/[a-zA-Z]+/}),f.registerType("any",{regex:/.+/}),f.registerType("list",{regex:/.+/,parser:["token",function(a){return a.split(",")}]}),f}])}.call(this),function(){angular.module("bicker_router").provider("State",function(){return{$get:["WatchableListFactory",function(a){var b;return b=a.create()}]}})}.call(this),function(){angular.module("bicker_router").provider("ViewBindings",function(){var a,b,c;return c={},a=function(){function a(a,b){this.name=a,this.bindings=b,this.bindings instanceof Array||(this.bindings=[this.bindings])}return a.prototype.getBindings=function(){return this.bindings},a}(),b={bind:function(b,d){var e,f,g,h,i;if(f=function(a,b){var c,d,e,f;for(f=[],d=0,e=i.length;d<e;d++)c=i[d],c.requiredState instanceof Array||(c.requiredState=[c.requiredState]),f.push(c.requiredState=c.requiredState.concat(b));return f},g=function(a,b){var c,d,e,f;for(f=[],d=0,e=i.length;d<e;d++)c=i[d],"resolve"in c||(c.resolve={}),f.push(_.defaults(c.resolve,b));return f},e=function(a){var b,c,e,i;for(b=[{name:"commonResolvingErrorTemplateUrl",overrideField:"resolvingErrorTemplateUrl"},{name:"commonResolvingErrorComponent",overrideField:"resolvingErrorComponent"},{name:"commonErrorComponent",overrideField:"errorComponent"},{name:"commonErrorTemplateUrl",overrideField:"errorTemplateUrl"}],e=0,i=b.length;e<i;e++)c=b[e],c.name in d&&h(a,c.overrideField,d[c.name]);if("commonRequiredState"in d&&f(a,d.commonRequiredState),"commonResolve"in d)return g(a,d.commonResolve)},h=function(a,b,c){var d,e,f,g;for(g=[],e=0,f=i.length;e<f;e++)d=i[e],b in d?g.push(void 0):g.push(d[b]=c);return g},i=[],i="bindings"in d?d.bindings:d instanceof Array?d:[d],!(i.length>0))throw new Error("Invalid call to ViewBindingsProvider.bind for name '"+b+"'");return e(i),c[b]=new a(b,i)},$get:function(){return{getView:function(a){return c[a]}}}}})}.call(this);
//# sourceMappingURL=bicker.min.js.map